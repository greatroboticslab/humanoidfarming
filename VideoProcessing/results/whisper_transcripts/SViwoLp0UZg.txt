Excel - Formula to Maybe Add Zero Prefix and Dash Suffix - Excel - Episode 1554
https://www.youtube.com/watch?v=SViwoLp0UZg
Education
 Hey, welcome back. It's time for another Dueling Excel podcast. I'm Bill Jelen from MrExcel. We'll be joined by Mike Girvin from Excel is Fun. This is our episode 107, Add 0 and Dash. All right, a question sent in from YouTube. If the first digit, we have a series of numbers here, if the first digit is a 3, insert a 0 at the front and a dash after the fourth digit. If it's not a 3, then 0 at the front and a dash after the third digit. All right, so let's, you know, my initial reaction is, hey, I wonder if we can do this with a custom number format. Choose those numbers, Ctrl-1, choose Custom, and this is generally a great way that we can put leading zeros in. So four zeros, a dash, and then seven zeros, and that will work perfectly for the numbers that start with a 3, but unfortunately, the numbers that start with a 4 are recurring two leading zeros instead of 1, so we're just going to undo that, Ctrl-Z, and go back. All right, so I think we're going to have to start with an IF statement here, although both conditions, whether it starts with a 3 or not, have a 0 at the front. Now, so that comes outside of the IF statement, equal in quotes a 0, ampersand, and then if the left of B5,3,1 is equal to a 3, then we want the left of B5,3, ampersand, in quotes, a dash, ampersand, the mid of B5. We're going to start one past the 3, so in other words, 4. How many do we want? I don't know, we just want 100. We just want a bunch. Okay, so that handles the situation where we have 3 as the starting digit. All other situations, though, we need to say, you know, what happens if it's not true. So I'm coming up here into the formula bar, and I'm choosing all of the characters including that comma, Ctrl-C to copy, Ctrl-V to paste, and now I've pasted the else portion of the IF statement. So in this case, I want the two left digits, and I want to start at position 3 instead of position 4. Closing paren, and let's see, there we go, 0,3,2,1. We'll double-click to shoot that down, and we get a leading 0 and the dash after the first two digits. So to me, this looks like some sort of a phone number system. I'm not sure exactly what it is, but I think that's the way to sell it. Mike, let's see what you have. Thanks, MrExcel. Hey, I love that formula. You used the mid, and my first idea was basically to do this same formula you did, except for I took the left and then joined it to the ampersand, and I did right. So I took the right function, I say count all of them with the len, and then subtract 3, so that way it would get all those numbers, right? And so there was two possibilities here, we subtracted 3 and 2. But then I was thinking, you know, that custom number formatting, that would be another way to go. So I could say the text function, which allows us to take a value and do custom number formatting. So I'm just going to take MrExcel's idea, and in double quotes put 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, right? That's the number format he did in the cells, but here, now we can get the text function to do it in a formula. Double click and send that down. But of course, it has that problem, and I actually added a few extra numbers just to test if I could come up with a formula that might do this, right? Too many zeros. So, no problem. How about we vary the number format, number of zeros, as we copy this down, we'll just say repeat. Repeat function can take the zero in double quotes, and how many times do you want to repeat it? Well, len will give us the length. Now, that will give us one too few, because we want one leading, so we just add one, right? So that gives me, and then I need one more close parentheses, control enter, double click and send it down. So that adds a leading zero only to one more than the length over here. Now, the last little trick here is we need a dash, right? If there's a three, we need to go one, two, so it needs to be the fourth one, zero, one, two, three, and then there needs to be dashed. Now, here's the thing. There is a function that can insert a character. It's called the replace function, and here's how the replace works. We'll say take this and insert a character, but the replace is going to ask us where do you want to start? One, two, three, four. Well, it looks like we want to start at four, but if you're inserting, you go to five, and then it will ask you how many characters, you tell it zero, and it will push the nine over and put a character there. So right here, I'm going to say replace. There's the old text, comma, the starting number. Now, the trick here is remember, if it's a three, we need a five, but if it's a four, we need a four, sorry, if it's anything besides the three, we need to only go in four characters, right? One, two, three, but we jump to the next one, to then force it to scoot over. So we need an if statement here. If, I'm going to do the left of this, comma, one, because that's what we're looking for, equals three. Now, left function spits out text, even if it's a number, so this wouldn't work. That's a mismatch, number against text. Of course, I have to put that in double quotes. If it's three, then what do I want? I need a five here. Remember, this is telling the replace where to go to insert, so five, otherwise four, close parentheses. So that if is delivering a four or five, and again, the start number, if you're inserting, has to be one more than the position you think you're supposed to go to, comma. Second important thing about inserting it is you tell number of characters zero. So the number of characters are zero, and then the new text, and double quote a dash, close parentheses. Ctrl-Enter, double click and send it down. I think that is working. So on the threes, it goes and puts it there four, otherwise it puts a three. All right, throw it back to MrExcel. Mike, that is so cool. I can't believe it. I've never used that version of replace. So the trick is, if I want to insert something before the C in cool, I have to count the character position of the C. And so using equal length of this is 25. So we'll use equal replace. The old text is up here in A2, comma, the 25, comma, zero, and then the new text from cell A7. All right, so if we have nothing in A7, it's just the string. If we choose something, that is amazing. A great way to insert new text at a certain spot. That is cool. Point to Excel is fun. Well, hey, I want to thank everyone for stopping by. I'll see you next week for another Dueling Excel podcast from MrExcel and Excel is fun.